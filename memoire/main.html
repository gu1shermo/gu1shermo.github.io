<div class="titlepage">
<div class="center">
<p><span><strong>Université Paris 8</strong></span><br />
<span><strong>Master Création Numérique</strong></span><br />
<span>parcours: <em>Arts et Technologies de l’Image
Virtuelle</em></span></p>
<hr />
<p><br />
<span> <strong>Vers une interaction authentique entre
<em>livecoders</em></strong></span><br />
<span><em>Forward The Revolution</em></span></p>
<hr />
<p><br />
</p>
<hr />
<p><br />
<span><strong>Guillaume Cournet</strong></span><br />
</p>
<hr />
<p><br />
</p>
<p><img src="images/logos/ATI_LogoNoir02.png" style="width:60.0%"
alt="image" /> <br />
<span><strong>Mémoire de Master 2, 2023 - 2024</strong></span></p>
</div>
</div>
<div class="titlepage">
<div class="flushleft">
<p><strong>Remerciements</strong></p>
</div>
<div class="flushleft">
<p>Ces remerciements font écho, d’une certaine manière, aux
<em>greetings</em><a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> de la <em>demoscene</em>.</p>
<p>Je tiens tout d’abord à exprimer mes sincères remerciements à
l’équipe pédagogique d’ATI pour son soutien et sa disponibilité tout au
long de mon parcours à ATI. Un merci particulier à Farès Belhadj pour
m’avoir donné l’opportunité d’assister à son cours de programmation
graphique en tant qu’auditeur libre. Grâce à ses explications claires et
détaillées, j’ai pu approfondir ma compréhension des concepts
mathématiques sous-jacents à la création d’une scène 3D. Un merci
particulier aussi à Alain Lioret pour m’avoir subtilement montré la voie
vers l’exploration de l’art numérique. Un grand merci à Jeff Jego pour
son soutien constant tout au long de cette année de M2, ainsi que pour
ses conseils avisés et pertinents auxquels a posteriori j’aurais dû
accorder plus d’attention.</p>
<p>Un énorme merci également à l’ensemble de ma promotion pour leur
bonne humeur et leur accueil chaleureux. Je tiens particulièrement à
adresser mes remerciements à Loïck pour son aide précieuse dans la
gestion du temps de rédaction de ce mémoire, ainsi qu’à Garvey pour son
« dématrixage » artistique.</p>
<p>Je ne saurais aussi passer sous silence l’apport essentiel d’Antoine
Boellinger, sans qui je n’aurais jamais découvert l’existence même des
<em>shaders</em>. Mes remerciements vont également à tous les membres du
Cookie Collective pour leur accueil bienveillant et leur partage de
connaissances. Je souhaite notamment exprimer ma reconnaissance envers
les animateurs d’atelier au Fuz : z0rg pour ses ateliers de <em>creative
coding</em>, Élie Gavoty pour ses sessions sur FoxDot, et Jules pour ses
enseignements sur SuperCollider. Je n’oublie pas non plus Pérégrine pour
son exigence mathématique et son dévouement dans la rédaction de la
précieuse documentation du wiki du Fuz.</p>
<p>Enfin, un grand merci à ma famille ainsi qu’à mon ami Nissim pour
leur soutien, leurs encouragements et leur implication dans la relecture
de ce mémoire, qui s’est avérée être indispensable.</p>
</div>
</div>
<div class="titlepage">
<div class="flushleft">
<p><strong>Préambule</strong></p>
</div>
<div class="flushleft">
<p>Le recours délibéré aux anglicismes mérite d’être souligné. Ces
termes anglais ont été sélectionnés pour leur précision et leur
pertinence dans le domaine du <em>live coding</em>. L’usage de ces
expressions étrangères s’inscrit dans le souhait de demeurer fidèle au
langage communément utilisé dans le milieu de la <em>demoscene</em>, où
l’influence de l’anglais est prépondérante. J’ai veillé à ce que ces
mots soient mis en <em>italique</em> dans le texte.</p>
<p>Par ailleurs, il me semblait important de préciser ma méthodologie
quant à l’utilisation de l’intelligence artificielle avec ChatGPT 3.5.
Cette dernière a été principalement sollicitée pour reformuler certains
paragraphes, tant du point de vue orthographique que du rythme des
phrases, et aussi dans le but d’éviter les répétitions. Cette
interaction avec l’IA peut être assimilée à un dialogue, similaire à une
partie de ping-pong, jusqu’à ce que le résultat satisfaisant soit
obtenu. En outre, j’ai également utilisé l’IA pour me suggérer des
titres de paragraphes lorsque j’étais en panne d’inspiration. Cependant,
j’ai également pris conscience des risques liés à la dépendance à l’IA.
À titre d’anecdote, dans le but d’économiser du temps, j’ai essayé de
résumer une vidéo d’une conférence portant sur l’histoire de la
<em>demoscene</em>, en fournissant à l’IA les sous-titres corrects de la
vidéo. Cependant, après avoir revu la vidéo ultérieurement, j’ai
constaté que l’IA ignorait des thèmes importants et mélangeait les dates
ainsi que les titres de <em>demos</em>. La leçon que j’en ai tirée est
qu’il est essentiel de toujours vérifier les informations produites par
l’IA, comme le souligne d’ailleurs l’interface de ChatGPT : <em>ChatGPT
can make mistakes. Consider checking important information</em>.</p>
</div>
</div>
<p> </p>
<p> </p>
<h1 id="introduction">Introduction</h1>
<p>Ma découverte du monde des <em>shaders</em> a été un véritable
tournant dans mon parcours. Préalablement à ma formation ATI, j’ai eu
l’opportunité d’acquérir une expérience précieuse en tant que
développeur au sein du département R&amp;D de Xilam Animation.</p>
<p>C’est grâce à mon mentor de l’époque, Antoine Boellinger, responsable
du <em>pipeline</em> et ancien d’ATI, que j’ai pris conscience de
l’existence même des <em>shaders</em>. Cette révélation a été pour moi
comme un choc électrique : la possibilité de créer des images à partir
des mathématiques m’a semblé magique et m’a profondément intrigué. Dès
lors, j’ai ressenti le besoin d’approfondir mes connaissances dans ce
domaine.</p>
<p>C’est au cours de la formation ATI que j’ai également eu
l’opportunité d’assister à une conférence du Cookie Collective à la
Gaîté Lyrique, expérience qui a été tout aussi marquante. Lors de cet
événement, j’ai été impressionné par la capacité des artistes à
improviser des visuels projetés sur grand écran, ainsi que par
l’utilisation de langages ésotériques pour produire de la musique. Ce
spectacle a éveillé en moi le désir de pouvoir un jour les imiter.</p>
<p>Depuis maintenant un peu plus d’un an, j’ai eu la chance d’assister à
des ateliers animés par z0rg au <em>hackerspace</em><a href="#fn2"
class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> le
Fuz. Grâce à son approche pédagogique qui va droit au but, j’ai pu
acquérir une grande partie de mes connaissances actuelles sur les
<em>shaders</em>. Ces ateliers m’ont également permis de découvrir une
communauté particulièrement généreuse, tant sur le plan humain que sur
le plan du partage des connaissances, et m’ont sensibilisé à l’esprit de
l’<em>open source</em><a href="#fn3" class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a>.</p>
<figure id="intro07">
<img src="images/introduction/intro04.jpg" />
<img src="images/introduction/intro07.png" />
<figcaption>Performance son / visuels (photo Émilie Corne)</figcaption>
</figure>
<p>À noter aussi qu’une certaine frustration a marqué mon parcours : le
sentiment de saturation lié à l’utilisation intensive de logiciels. Pour
répondre à cette frustration, j’ai décidé de m’éloigner autant que
possible de ces outils, dans une volonté affirmée de sortir de ma zone
de confort.</p>
<p>Cette expérience avec le Cookie Collective a été source d’inspiration
pour moi et a réaffirmé l’importance de la liberté créative et du
pouvoir du collectif. Elle a ravivé en moi l’espoir en un art novateur,
capable de dépasser les limites du « cinéma » tel que nous le
connaissons aujourd’hui, et d’explorer de nouvelles voies d’expression
artistique. L’esprit de communauté et l’organisation autonome de ce
collectif m’ont rappelé les mouvements de <em>free parties</em><a
href="#fn4" class="footnote-ref" id="fnref4"
role="doc-noteref"><sup>4</sup></a> des années 90 qui ont eu une
influence profonde sur la culture et l’esthétique numériques
contemporaines.</p>
<p>En assistant aux performances, j’ai constaté que l’interaction entre
le <em>livecoder</em> de <em>shaders</em> et celui de musique était
artificielle. Habituellement, c’est le <em>livecoder</em> des
<em>shaders</em> qui ajuste ses variables en fonction du son qu’il
entend, permettant ainsi au visuel de suivre le rythme. Bien que cela
puisse duper le public, cette observation m’a incité à rechercher un
moyen d’obtenir une interaction authentique entre le son et le visuel.
C’est précisément le sujet principal abordé dans ce mémoire.</p>
<p>Dans la première partie, je revisiterai les origines de la
<em>demoscene</em>, en adoptant un angle plus historique que technique.
Cette démarche répond à un double objectif : enrichir ma culture
personnelle et mieux comprendre cet univers pour m’y intégrer
pleinement.</p>
<p>La deuxième partie, précédée d’un bref rappel sur le
<em>pipeline</em> graphique, constitue une sorte de tutoriel visant à
présenter les techniques essentielles du <em>livecoding</em>. Pour des
raisons de lisibilité, j’ai opté pour une décomposition en deux
sections. La première traitera des techniques fondamentales pour écrire
des <em>fragment shaders</em> en temps réel, tandis que la seconde
explorera des techniques plus avancées mais optionnelles.</p>
<p>Conscient que certains de mes camarades de promotion sont passionnés
par le développement et la manipulation des <em>shaders</em> sans
nécessairement maîtriser la logique mathématique sous-jacente, j’ai
cherché à rendre ces concepts accessibles et didactiques. J’espère ainsi
susciter leur intérêt pour la programmation des <em>shaders</em>.</p>
<p>Enfin, la dernière partie de ce mémoire sera consacrée à mes
expérimentations, mettant en lumière certains langages spécifiques au
<em>livecoding</em> musical, notamment FoxDot et Orca. Ces solutions se
sont avérées parfaitement adaptées à mes besoins, car FoxDot offre une
expérience proche de la notation musicale traditionnelle, en rapport
avec mon expérience en gravure musicale<a href="#fn5"
class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>,
tandis qu’Orca m’a séduit par sa syntaxe originale et sa créativité
graphique.</p>
<p>Après avoir exploré en détail la structure d’un fichier MIDI
(consultable en annexe), la fin de cette dernière partie sera consacrée
à l’introduction d’une solution visant à récupérer les informations MIDI
en vue d’animer un <em>shader</em>. Cette approche évite l’utilisation
de logiciels tiers pour se rapprocher d’un <em>pipeline</em> de
développement purement basé sur le code.</p>
<p>Il me semblait aussi important de souligner que mon intention
première était d’inclure des chapitres dédiés à l’<em>algorave</em> et à
la musique algorithmique. Cependant, en raison d’une contrainte de temps
et d’une surestimation de mes capacités, j’ai été contraint d’abandonner
ces sujets.</p>
<figure id="intro02">
<img src="images/introduction/intro06.png" />
<img src="images/introduction/intro02.jpg" />
<figcaption>Performance musique/<em>shaders</em> au bar la Chair de
Poule (photo Léon Denise)</figcaption>
</figure>
<h1 id="conclusion">Conclusion</h1>
<p>Dans ce mémoire, j’ai exploré les origines de l’art de la
<em>demoscene</em> et examiné les techniques essentielles pour une
performance de <em>livecoding</em> de <em>shaders</em> réussie. Par la
suite, j’ai centré mon analyse sur l’interaction authentique entre la
musique et le visuel, dans l’espoir de contribuer modestement à
l’évolution de la <em>demoscene</em>.</p>
<h5 class="unnumbered" id="mes-expérimentations">Mes
expérimentations</h5>
<p>Au cours de mes explorations, j’ai réalisé quelques expérimentations
disponibles sur Vimeo. Bien qu’en l’état peu ambitieuses, elles servent
de preuve de concept<a href="#fn6" class="footnote-ref" id="fnref6"
role="doc-noteref"><sup>6</sup></a> : si j’ai réussi à modifier le rayon
d’un cercle uniquement avec la vélocité de la note jouée, cela démontre
la possibilité d’agir sur n’importe quelle variable définie dans le code
GLSL (voir <a href="#experim00" data-reference-type="ref"
data-reference="experim00">[experim00]</a> et <a href="#experim01"
data-reference-type="ref" data-reference="experim01">2.1</a> <a
href="https://vimeo.com/user167850166">sur ma page Vimeo</a>).</p>
<figure id="experim01">
<img src="images/experiments/intensifs/experim00.png" />
<img src="images/experiments/intensifs/experim01.png" />
<figcaption><em>Live</em> avec une note aléatoire</figcaption>
</figure>
<p>Maintenant que j’ai confirmé que les mécanismes interactifs
nécessaires sont déjà établis et fonctionnels, je suis prêt à explorer
ce nouveau <em>pipeline</em> qui répond parfaitement à mes attentes. À
chaque itération, j’améliore le flux de travail en factorisant le code,
en ajoutant des fonctionnalités, en peaufinant l’animation, etc. (voir
<a href="#experim03" data-reference-type="ref"
data-reference="experim03">[experim03]</a> et <a href="#experim02"
data-reference-type="ref" data-reference="experim02">2.2</a>)</p>
<figure id="experim02">
<img src="images/experiments/experim03.png" />
<img src="images/experiments/experim02.png" />
<figcaption><em>Hack</em> pour la transparence d’Orca</figcaption>
</figure>
<h5 class="unnumbered" id="journée-détude-sur-le-live-coding">Journée
d’étude sur le <em>live coding</em></h5>
<p>Un récent événement qui a profondément marqué mon expérience était la
« journée d’étude sur le live coding », orchestrée par Raphaël Forment,
Rémi Georges et Agathe Herrou à la Maison des Sciences de l’Homme à La
Plaine St-Denis (voir <a href="#jlc00" data-reference-type="ref"
data-reference="jlc00">2.3</a>). Cette journée comprenait une série de
conférences suivies de performances sonores et visuelles. C’est lors de
cet événement que j’ai vraiment pris conscience que le
<em>livecoding</em> était un véritable domaine de recherche et de
création, réunissant des artistes, des chercheurs et des passionnés aux
parcours différents autour d’un geste commun : celui de manipuler du
code source « à la volée » dans un but d’expression artistique et de
création. Une présentation qui a captivé mon attention est celle de
Vincent Rioux : <em>Redécouvrir le live-coding en LISP, i-a-d-d-la-joie
! – Utiliser Lisp et Supercollider avec une intelligence simple</em>.
Son travail met en avant la création d’un lien entre la musique et les
arts visuels, notamment entre les Beaux-Arts de Paris et l’IRCAM
(Institut de Recherche et de Coordination Acoustique/Musique). Je
prévois d’approfondir ses travaux, car les sujets qu’il aborde semblent
étroitement liés aux miens.</p>
<figure id="jlc00">
<img src="images/jlc_affiche.png" style="width:6cm" />
<figcaption>Affiche de la journée d’étude sur le
<em>livecoding</em></figcaption>
</figure>
<h5 class="unnumbered"
id="vers-un-mélange-des-arts-et-la-démocratisation-de-la-demoscene">Vers
un mélange des arts et la démocratisation de la <em>demoscene</em></h5>
<p>Grâce aux rencontres que j’ai pu faire cette année lors des
événements organisés par le Cookie Collective, j’ai eu l’opportunité
d’explorer de nouvelles perspectives. En particulier, ma brève rencontre
avec Alexandre et Sharlaine, les organisateurs du Playground (voir <a
href="#peanut" data-reference-type="ref"
data-reference="peanut">2.4</a>), un événement dédié au <em>creative
coding</em> à Bordeaux, m’a profondément inspiré (leur site est
consultable <a href="https://plgrnd.cc/">ici</a>). Leur approche
originale renforce mon désir de rendre la <em>demoscene</em> plus
accessible en mettant l’accent sur la diffusion d’une éducation
technique capable de sensibiliser et d’impliquer un public plus large.
De plus, leur collaboration en tant que duo, « La Peanut », qui combine
le <em>livecoding</em>, le théâtre et la poésie, reflète également mes
aspirations à faire progresser mes recherches et mes créations
numériques vers un « mélange des arts ». Ces arts pourraient inclure des
récitations de texte (narratives ou non), l’intégration d’instruments
acoustiques ou encore la manipulation de vidéos en direct.</p>
<figure id="peanut">
<img src="images/conclusion/peanut00.png" />
<img src="images/conclusion/peanut01.png" />
<figcaption>Programme du Playground organisé par Alexandre</figcaption>
</figure>
<h5 class="unnumbered" id="vers-une-communication-réseau">Vers une
communication réseau</h5>
<p>Jusqu’à présent, mes expérimentations techniques ont été réalisées
sur une seule machine. Cependant, comme l’indique le titre de mon
mémoire, « <em>Vers une interaction authentique entre livecoders</em> »,
cela illustre également mon désir initial d’impliquer plusieurs
<em>livecoders</em> au cours d’une même performance. En pratique, un
<em>livecoder</em> serait responsable de la création musicale sur Orca
et enverrait les informations MIDI via le réseau à une autre machine
contrôlée par un <em>livecoder</em> de <em>shaders</em>. Cet objectif
constituait le cœur de mon intensif en M2. Malheureusement, notre groupe
a dû faire face à de nombreuses complications, à la fois matérielles et
logistiques, qui nous ont empêché d’atteindre cet objectif dans les
délais impartis. Cependant, avec le recul, j’ai découvert l’existence de
solutions déjà disponibles qui auraient pu nous faciliter la
réalisation. Parmi les solutions envisagées, je compte explorer Troop et
Flok, des logiciels permettant à plusieurs utilisateurs de pratiquer le
<em>livecoding</em> musical sur un serveur commun. Dans mes futures
recherches, je m’efforcerai de trouver une solution équivalente mais
orientée vers l’intégration collaborative du visuel et du sonore.</p>
<figure id="stribe00">
<img src="images/conclusion/stribe.png" style="width:6cm" />
<figcaption>Goodbye!</figcaption>
</figure>
<h1 id="appendix:orcaops">Liste opérateurs Orca</h1>
<h2 class="unnumbered" id="en-anglais">En anglais</h2>
<ul>
<li><p><strong>A</strong> : add(a b) – Outputs sum of inputs.</p></li>
<li><p><strong>B</strong> : subtract(a b) – Outputs difference of
inputs.</p></li>
<li><p><strong>C</strong> : clock(rate mod) – Outputs modulo of
frame.</p></li>
<li><p><strong>D</strong> : delay(rate mod) – Bangs on modulo of
frame.</p></li>
<li><p><strong>E</strong> : east – Moves eastward, or bangs.</p></li>
<li><p><strong>F</strong> : if(a b) – Bangs if inputs are
equal.</p></li>
<li><p><strong>G</strong> : generator(x y len) – Writes operands with
offset.</p></li>
<li><p><strong>H</strong> : halt – Halts southward operand.</p></li>
<li><p><strong>I</strong> : increment(step mod) – Increments southward
operand.</p></li>
<li><p><strong>J</strong> : jumper(val) – Outputs northward
operand.</p></li>
<li><p><strong>K</strong> : konkat(len) – Reads multiple
variables.</p></li>
<li><p><strong>L</strong> : lesser(a b) – Outputs smallest of
inputs.</p></li>
<li><p><strong>M</strong> : multiply(a b) – Outputs product of
inputs.</p></li>
<li><p><strong>N</strong> : north – Moves Northward, or bangs.</p></li>
<li><p><strong>O</strong> : read(x y read) – Reads operand with
offset.</p></li>
<li><p><strong>P</strong> : push(len key val) – Writes eastward
operand.</p></li>
<li><p><strong>Q</strong> : query(x y len) – Reads operands with
offset.</p></li>
<li><p><strong>R</strong> : random(min max) – Outputs random
value.</p></li>
<li><p><strong>S</strong> : south – Moves southward, or bangs.</p></li>
<li><p><strong>T</strong> : track(key len val) – Reads eastward
operand.</p></li>
<li><p><strong>U</strong> : uclid(step max) – Bangs on Euclidean
rhythm.</p></li>
<li><p><strong>V</strong> : variable(write read) – Reads and writes
variable.</p></li>
<li><p><strong>W</strong> : west – Moves westward, or bangs.</p></li>
<li><p><strong>X</strong> : write(x y val) – Writes operand with
offset.</p></li>
<li><p><strong>Y</strong> : jymper(val) – Outputs westward
operand.</p></li>
<li><p><strong>Z</strong> : lerp(rate target) – Transitions operand to
input.</p></li>
<li><p><strong>*</strong> : bang – Bangs neighboring operands.</p></li>
<li><p><strong>#</strong> : comment – Halts a line.</p></li>
<li><p><strong>:</strong> : midi(channel octave note velocity length) –
Sends a MIDI note.</p></li>
<li><p><strong>%</strong> : mono(channel octave note velocity length) –
Sends monophonic MIDI note.</p></li>
<li><p><strong>!</strong> : cc(channel knob value) – Sends MIDI control
change.</p></li>
<li><p><strong>?</strong> : pb(channel value) – Sends MIDI pitch
bend.</p></li>
<li><p><strong>;</strong> : udp – Sends UDP message.</p></li>
<li><p><strong>=</strong> : osc(path) – Sends OSC message.</p></li>
<li><p><strong>$</strong> : self – Sends ORCA commands.</p></li>
</ul>
<h2 class="unnumbered" id="en-français">En français</h2>
<ul>
<li><p><strong>A</strong> : add(a b) – Renvoie la somme des
entrées.</p></li>
<li><p><strong>B</strong> : subtract(a b) – Renvoie la différence des
entrées.</p></li>
<li><p><strong>C</strong> : clock(rate mod) – Renvoie le modulo de la
<em>frame</em>.</p></li>
<li><p><strong>D</strong> : delay(rate mod) – Déclenche un <em>bang</em>
sur le modulo de la <em>frame</em>.</p></li>
<li><p><strong>E</strong> : east – Se déplace vers l’est, ou déclenche
un <em>bang</em>.</p></li>
<li><p><strong>F</strong> : if(a b) – Déclenche si les entrées sont
égales.</p></li>
<li><p><strong>G</strong> : generator(x y len) – Écrit les opérandes
avec un <em>offset</em>.</p></li>
<li><p><strong>H</strong> : halt – Arrête l’opérateur Sud.</p></li>
<li><p><strong>I</strong> : increment(step mod) – Incrémente l’opérateur
Sud.</p></li>
<li><p><strong>J</strong> : jumper(val) – Renvoie l’opérande vers le
nord.</p></li>
<li><p><strong>K</strong> : konkat(len) – Lit plusieurs
variables.</p></li>
<li><p><strong>L</strong> : lesser(a b) – Renvoie la plus petite des
entrées.</p></li>
<li><p><strong>M</strong> : multiply(a b) – Renvoie le produit des
entrées.</p></li>
<li><p><strong>N</strong> : north – Se déplace vers le nord, ou
déclenche un <em>bang</em>.</p></li>
<li><p><strong>O</strong> : read(x y read) – Lit l’opérande avec un
décalage.</p></li>
<li><p><strong>P</strong> : push(len key val) – Écrit l’opérande vers
l’est.</p></li>
<li><p><strong>Q</strong> : query(x y len) – Lit les opérandes avec un
décalage.</p></li>
<li><p><strong>R</strong> : random(min max) – Renvoie une valeur
aléatoire.</p></li>
<li><p><strong>S</strong> : south – Se déplace vers le sud, ou déclenche
un <em>bang</em>.</p></li>
<li><p><strong>T</strong> : track(key len val) – Lit l’opérande vers
l’est.</p></li>
<li><p><strong>U</strong> : uclid(step max) – Déclenche sur un rythme
euclidien.</p></li>
<li><p><strong>V</strong> : variable(écrire lire) – Lit et écrit une
variable.</p></li>
<li><p><strong>W</strong> : west – Se déplace vers l’ouest, ou déclenche
un <em>bang</em>.</p></li>
<li><p><strong>X</strong> : write(x y val) – Écrit l’opérande avec un
décalage.</p></li>
<li><p><strong>Y</strong> : jymper(val) – Renvoie l’opérande vers
l’ouest.</p></li>
<li><p><strong>Z</strong> : lerp(rate target) – Transitions de
l’opérande vers l’entrée.</p></li>
<li><p><strong>*</strong> : bang – Déclenche les opérandes
voisines.</p></li>
<li><p><strong>#</strong> : comment – Arrête une ligne.</p></li>
<li><p><strong>:</strong> : midi(canal octave note vélocité durée) –
Envoie une note MIDI.</p></li>
<li><p><strong>%</strong> : mono(canal octave note vélocité durée) –
Envoie une note MIDI monophonique.</p></li>
<li><p><strong>!</strong> : cc(canal bouton valeur) – Envoie un message
de changement de contrôle MIDI.</p></li>
<li><p><strong>?</strong> : pb(canal valeur) – Envoie un message de
pitch bend MIDI.</p></li>
<li><p><strong>;</strong> : udp – Envoie un message UDP.</p></li>
<li><p><strong>=</strong> : osc(chemin) – Envoie un message
OSC.</p></li>
<li><p><strong>$</strong> : self – Envoie des commandes ORCA.</p></li>
</ul>
<h1 id="appendix:codemidi">Code C/C++ pour composer de la musique</h1>
<div class="sourceCode" id="cb1" data-language="C++"
data-caption="CPP MIDI" data-captionpos="b"><pre
class="sourceCode c++"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span><span class="pp">   </span><span class="co">// For std::vector&lt;&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span><span class="pp">  </span><span class="co">// For std::strlen()</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span><span class="pp">   </span><span class="co">// For std::fopen(), std::fwrite(), std::fclose()</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">unsigned</span> <span class="dt">char</span> byte<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">/* First define a custom wrapper over std::vector&lt;byte&gt;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"> * so we can quickly push_back multiple bytes with a single call.</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MIDIvec<span class="op">:</span> <span class="kw">public</span> <span class="bu">std::</span>vector<span class="op">&lt;</span>byte<span class="op">&gt;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Methods for appending raw data into the vector:</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> Args<span class="op">&gt;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddBytes<span class="op">(</span>byte data<span class="op">,</span> Args<span class="op">...</span>args<span class="op">)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        push_back<span class="op">(</span>data<span class="op">);</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        AddBytes<span class="op">(</span>args<span class="op">...);</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> Args<span class="op">&gt;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddBytes<span class="op">(</span><span class="at">const</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">,</span> Args<span class="op">...</span>args<span class="op">)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        insert<span class="op">(</span>end<span class="op">(),</span> s<span class="op">,</span> s <span class="op">+</span> <span class="bu">std::</span>strlen<span class="op">(</span>s<span class="op">));</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        AddBytes<span class="op">(</span>args<span class="op">...);</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddBytes<span class="op">()</span> <span class="op">{</span> <span class="op">}</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">/* Define a class which encodes MIDI events into a track */</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MIDItrack<span class="op">:</span> <span class="kw">public</span> MIDIvec</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span><span class="op">:</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> delay<span class="op">,</span> running_status<span class="op">;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    MIDItrack<span class="op">()</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> MIDIvec<span class="op">(),</span> delay<span class="op">(</span><span class="dv">0</span><span class="op">),</span> running_status<span class="op">(</span><span class="dv">0</span><span class="op">)</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Methods for indicating how much time elapses:</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddDelay<span class="op">(</span><span class="dt">unsigned</span> amount<span class="op">)</span> <span class="op">{</span> delay <span class="op">+=</span> amount<span class="op">;</span> <span class="op">}</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddVarLen<span class="op">(</span><span class="dt">unsigned</span> t<span class="op">)</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>t <span class="op">&gt;&gt;</span> <span class="dv">21</span><span class="op">)</span> AddBytes<span class="op">(</span><span class="bn">0x80</span> <span class="op">|</span> <span class="op">((</span>t <span class="op">&gt;&gt;</span> <span class="dv">21</span><span class="op">)</span> <span class="op">&amp;</span> <span class="bn">0x7F</span><span class="op">));</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>t <span class="op">&gt;&gt;</span> <span class="dv">14</span><span class="op">)</span> AddBytes<span class="op">(</span><span class="bn">0x80</span> <span class="op">|</span> <span class="op">((</span>t <span class="op">&gt;&gt;</span> <span class="dv">14</span><span class="op">)</span> <span class="op">&amp;</span> <span class="bn">0x7F</span><span class="op">));</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>t <span class="op">&gt;&gt;</span>  <span class="dv">7</span><span class="op">)</span> AddBytes<span class="op">(</span><span class="bn">0x80</span> <span class="op">|</span> <span class="op">((</span>t <span class="op">&gt;&gt;</span>  <span class="dv">7</span><span class="op">)</span> <span class="op">&amp;</span> <span class="bn">0x7F</span><span class="op">));</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        AddBytes<span class="op">(((</span>t <span class="op">&gt;&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">&amp;</span> <span class="bn">0x7F</span><span class="op">));</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Flush<span class="op">()</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        AddVarLen<span class="op">(</span>delay<span class="op">);</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>        delay <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Methods for appending events into the track:</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> Args<span class="op">&gt;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddEvent<span class="op">(</span>byte data<span class="op">,</span> Args<span class="op">...</span>args<span class="op">)</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        <span class="co">/* MIDI tracks have the following structure:</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co">         *</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co">         * { timestamp [metaevent ... ] event } ...</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co">         *</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co">         * Each event is prefixed with a timestamp,</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co">         * which is encoded in a variable-length format.</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="co">         * The timestamp describes the amount of time that</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="co">         * must be elapsed before this event can be handled.</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="co">         *</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="co">         * After the timestamp, comes the event data.</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="co">         * The first byte of the event always has the high bit on,</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co">         * and the remaining bytes always have the high bit off.</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="co">         *</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="co">         * The first byte can however be omitted; in that case,</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="co">         * it is assumed that the first byte is the same as in</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="co">         * the previous command. This is called &quot;running status&quot;.</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="co">         * The event may furthermore beprefixed</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="co">         * with a number of meta events.</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="co">         */</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>       Flush<span class="op">();</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span><span class="op">(</span>data <span class="op">!=</span> running_status<span class="op">)</span> AddBytes<span class="op">(</span>running_status <span class="op">=</span> data<span class="op">);</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>       AddBytes<span class="op">(</span>args<span class="op">...);</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddEvent<span class="op">()</span> <span class="op">{</span> <span class="op">}</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span><span class="op">...</span> Args<span class="op">&gt;</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddMetaEvent<span class="op">(</span>byte metatype<span class="op">,</span> byte nbytes<span class="op">,</span> Args<span class="op">...</span>args<span class="op">)</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        Flush<span class="op">();</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>        AddBytes<span class="op">(</span><span class="bn">0xFF</span><span class="op">,</span> metatype<span class="op">,</span> nbytes<span class="op">,</span> args<span class="op">...);</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Key-related parameters: channel number, note number, pressure</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> KeyOn<span class="op">(</span><span class="dt">int</span> ch<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span>    <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>n<span class="op">&gt;=</span><span class="dv">0</span><span class="op">)</span>AddEvent<span class="op">(</span><span class="bn">0x90</span><span class="op">|</span>ch<span class="op">,</span> n<span class="op">,</span> p<span class="op">);</span> <span class="op">}</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> KeyOff<span class="op">(</span><span class="dt">int</span> ch<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span>   <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>n<span class="op">&gt;=</span><span class="dv">0</span><span class="op">)</span>AddEvent<span class="op">(</span><span class="bn">0x80</span><span class="op">|</span>ch<span class="op">,</span> n<span class="op">,</span> p<span class="op">);</span> <span class="op">}</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> KeyTouch<span class="op">(</span><span class="dt">int</span> ch<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>n<span class="op">&gt;=</span><span class="dv">0</span><span class="op">)</span>AddEvent<span class="op">(</span><span class="bn">0xA0</span><span class="op">|</span>ch<span class="op">,</span> n<span class="op">,</span> p<span class="op">);</span> <span class="op">}</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Events with other types of parameters:</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Control<span class="op">(</span><span class="dt">int</span> ch<span class="op">,</span> <span class="dt">int</span> c<span class="op">,</span> <span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span> AddEvent<span class="op">(</span><span class="bn">0xB0</span><span class="op">|</span>ch<span class="op">,</span> c<span class="op">,</span> v<span class="op">);</span> <span class="op">}</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Patch<span class="op">(</span><span class="dt">int</span> ch<span class="op">,</span> <span class="dt">int</span> patchno<span class="op">)</span>    <span class="op">{</span> AddEvent<span class="op">(</span><span class="bn">0xC0</span><span class="op">|</span>ch<span class="op">,</span> patchno<span class="op">);</span> <span class="op">}</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Wheel<span class="op">(</span><span class="dt">int</span> ch<span class="op">,</span> <span class="dt">unsigned</span> value<span class="op">)</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> AddEvent<span class="op">(</span><span class="bn">0xE0</span><span class="op">|</span>ch<span class="op">,</span> value<span class="op">&amp;</span><span class="bn">0x7F</span><span class="op">,</span> <span class="op">(</span>value<span class="op">&gt;&gt;</span><span class="dv">7</span><span class="op">)&amp;</span><span class="bn">0x7F</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Methods for appending metadata into the track:</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddText<span class="op">(</span><span class="dt">int</span> texttype<span class="op">,</span> <span class="at">const</span> <span class="dt">char</span><span class="op">*</span> text<span class="op">)</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>        AddMetaEvent<span class="op">(</span>texttype<span class="op">,</span> <span class="bu">std::</span>strlen<span class="op">(</span>text<span class="op">),</span> text<span class="op">);</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="co">/* Define a class that encapsulates all methods needed to craft a MIDI file. */</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MIDIfile<span class="op">:</span> <span class="kw">public</span> MIDIvec</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span><span class="op">:</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>vector<span class="op">&lt;</span>MIDItrack<span class="op">&gt;</span> tracks<span class="op">;</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> deltaticks<span class="op">,</span> tempo<span class="op">;</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    MIDIfile<span class="op">()</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> MIDIvec<span class="op">(),</span> tracks<span class="op">(),</span> deltaticks<span class="op">(</span><span class="dv">1000</span><span class="op">),</span> tempo<span class="op">(</span><span class="dv">1000000</span><span class="op">)</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddLoopStart<span class="op">()</span>  <span class="op">{</span> <span class="op">(*</span><span class="kw">this</span><span class="op">)[</span><span class="dv">0</span><span class="op">].</span>AddText<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="st">&quot;loopStart&quot;</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddLoopEnd<span class="op">()</span>    <span class="op">{</span> <span class="op">(*</span><span class="kw">this</span><span class="op">)[</span><span class="dv">0</span><span class="op">].</span>AddText<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="st">&quot;loopEnd&quot;</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    MIDItrack<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">[]</span> <span class="op">(</span><span class="dt">unsigned</span> trackno<span class="op">)</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>trackno <span class="op">&gt;=</span> tracks<span class="op">.</span>size<span class="op">())</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>            tracks<span class="op">.</span>reserve<span class="op">(</span><span class="dv">16</span><span class="op">);</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>            tracks<span class="op">.</span>resize<span class="op">(</span>trackno<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>        MIDItrack<span class="op">&amp;</span> result <span class="op">=</span> tracks<span class="op">[</span>trackno<span class="op">];</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>result<span class="op">.</span>empty<span class="op">())</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Meta 0x58 (misc settings):</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>                <span class="co">//      time signature: 4/2</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>                <span class="co">//      ticks/metro:    24</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>                <span class="co">//      32nd per 1/4:   8</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>            result<span class="op">.</span>AddMetaEvent<span class="op">(</span><span class="bn">0x58</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span>  <span class="dv">4</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span> <span class="dv">24</span><span class="op">,</span><span class="dv">8</span><span class="op">);</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Meta 0x51 (tempo):</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>            result<span class="op">.</span>AddMetaEvent<span class="op">(</span><span class="bn">0x51</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span>  tempo<span class="op">&gt;&gt;</span><span class="dv">16</span><span class="op">,</span> tempo<span class="op">&gt;&gt;</span><span class="dv">8</span><span class="op">,</span> tempo<span class="op">);</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> Finish<span class="op">()</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>        clear<span class="op">();</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>        AddBytes<span class="op">(</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>            <span class="co">// MIDI signature (MThd and number 6)</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;MThd&quot;</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">6</span><span class="op">,</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Format number (1: multiple tracks, synchronous)</span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>            tracks<span class="op">.</span>size<span class="op">()</span> <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">,</span> tracks<span class="op">.</span>size<span class="op">(),</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>            deltaticks    <span class="op">&gt;&gt;</span> <span class="dv">8</span><span class="op">,</span> deltaticks<span class="op">);</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">unsigned</span> a<span class="op">=</span><span class="dv">0</span><span class="op">;</span> a<span class="op">&lt;</span>tracks<span class="op">.</span>size<span class="op">();</span> <span class="op">++</span>a<span class="op">)</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Add meta 0x2F to the track, indicating the track end:</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>            tracks<span class="op">[</span>a<span class="op">].</span>AddMetaEvent<span class="op">(</span><span class="bn">0x2F</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Add the track into the MIDI file:</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>            AddBytes<span class="op">(</span><span class="st">&quot;MTrk&quot;</span><span class="op">,</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>                tracks<span class="op">[</span>a<span class="op">].</span>size<span class="op">()</span> <span class="op">&gt;&gt;</span> <span class="dv">24</span><span class="op">,</span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>                tracks<span class="op">[</span>a<span class="op">].</span>size<span class="op">()</span> <span class="op">&gt;&gt;</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>                tracks<span class="op">[</span>a<span class="op">].</span>size<span class="op">()</span> <span class="op">&gt;&gt;</span>  <span class="dv">8</span><span class="op">,</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>                tracks<span class="op">[</span>a<span class="op">].</span>size<span class="op">()</span> <span class="op">&gt;&gt;</span>  <span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>            insert<span class="op">(</span>end<span class="op">(),</span> tracks<span class="op">[</span>a<span class="op">].</span>begin<span class="op">(),</span> tracks<span class="op">[</span>a<span class="op">].</span>end<span class="op">());</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Now that we have a class that can create MIDI files, let&#39;s create</span></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>    <span class="co">// music.</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Begin with some chords.</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="at">const</span> <span class="dt">int</span> chords<span class="op">[][</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">12</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">7</span> <span class="op">},</span> <span class="co">// +C  E  G  = 0</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">12</span><span class="op">,</span><span class="dv">9</span><span class="op">,</span><span class="dv">5</span> <span class="op">},</span> <span class="co">// +C  A  F  = 1</span></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">12</span><span class="op">,</span><span class="dv">8</span><span class="op">,</span><span class="dv">3</span> <span class="op">},</span> <span class="co">// +C  G# D# = 2</span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">12</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">3</span> <span class="op">},</span> <span class="co">// +C  G  D# = 3</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">12</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">8</span> <span class="op">},</span> <span class="co">// +C  F  G# = 4</span></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">12</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">8</span> <span class="op">},</span> <span class="co">// +C  D# G# = 5</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">11</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">7</span> <span class="op">},</span> <span class="co">//  B  D  G  = 6</span></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">10</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">7</span> <span class="op">},</span> <span class="co">// A#  D  G  = 7</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">14</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">5</span> <span class="op">},</span> <span class="co">// +D  G  F  = 8</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">14</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">11</span> <span class="op">},</span><span class="co">// +D  G  B  = 9</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span> <span class="dv">14</span><span class="op">,</span><span class="dv">19</span><span class="op">,</span><span class="dv">11</span> <span class="op">}</span><span class="co">// +D +G  B  = 10</span></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">char</span> x <span class="op">=</span> <span class="dv">99</span><span class="op">;</span> <span class="co">// Arbitrary value we use here to indicate &quot;no note&quot;</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="at">const</span> <span class="dt">char</span> chordline<span class="op">[</span><span class="dv">64</span><span class="op">]</span> <span class="op">=</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span><span class="op">,</span>x<span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span>x<span class="op">,</span><span class="dv">0</span><span class="op">,</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span>x<span class="op">,</span><span class="dv">1</span><span class="op">,</span>x<span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span>x<span class="op">,</span><span class="dv">1</span><span class="op">,</span>x<span class="op">,</span>  <span class="dv">2</span><span class="op">,</span>x<span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span>x<span class="op">,</span><span class="dv">2</span><span class="op">,</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span>x<span class="op">,</span><span class="dv">3</span><span class="op">,</span>x<span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span>x<span class="op">,</span><span class="dv">3</span><span class="op">,</span>x<span class="op">,</span></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>        <span class="dv">4</span><span class="op">,</span>x<span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span>x<span class="op">,</span><span class="dv">4</span><span class="op">,</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span>x<span class="op">,</span><span class="dv">5</span><span class="op">,</span>x<span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span>x<span class="op">,</span><span class="dv">5</span><span class="op">,</span>x<span class="op">,</span>  <span class="dv">6</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">6</span><span class="op">,</span>x<span class="op">,</span><span class="dv">8</span><span class="op">,</span>x<span class="op">,</span><span class="dv">9</span><span class="op">,</span>x<span class="op">,</span><span class="dv">10</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="at">const</span> <span class="dt">char</span> chordline2<span class="op">[</span><span class="dv">64</span><span class="op">]</span> <span class="op">=</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>  <span class="dv">2</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>        <span class="dv">4</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>  <span class="dv">6</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span> <span class="dv">6</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="at">const</span> <span class="dt">char</span> bassline<span class="op">[</span><span class="dv">64</span><span class="op">]</span> <span class="op">=</span></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>  <span class="dv">8</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span><span class="dv">0</span><span class="op">,</span>x<span class="op">,</span><span class="dv">3</span><span class="op">,</span>x<span class="op">,</span> <span class="dv">7</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>        <span class="dv">5</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>  <span class="dv">2</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,-</span><span class="dv">5</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span>x</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="at">const</span> <span class="dt">char</span> fluteline<span class="op">[</span><span class="dv">64</span><span class="op">]</span> <span class="op">=</span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>        <span class="dv">12</span><span class="op">,</span>x<span class="op">,</span><span class="dv">12</span><span class="op">,</span><span class="dv">12</span><span class="op">,</span> x<span class="op">,</span><span class="dv">9</span><span class="op">,</span> x<span class="op">,</span> <span class="dv">17</span><span class="op">,</span>x<span class="op">,</span><span class="dv">16</span><span class="op">,</span>x<span class="op">,</span><span class="dv">14</span><span class="op">,</span>x<span class="op">,</span><span class="dv">12</span><span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>         <span class="dv">8</span><span class="op">,</span>x<span class="op">,</span> x<span class="op">,</span><span class="dv">15</span><span class="op">,</span><span class="dv">14</span><span class="op">,</span>x<span class="op">,</span><span class="dv">12</span><span class="op">,</span>  x<span class="op">,</span><span class="dv">7</span><span class="op">,</span> x<span class="op">,</span>x<span class="op">,</span> x<span class="op">,</span>x<span class="op">,</span> x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>         <span class="dv">8</span><span class="op">,</span>x<span class="op">,</span> x<span class="op">,</span> <span class="dv">8</span><span class="op">,</span><span class="dv">12</span><span class="op">,</span>x<span class="op">,</span> <span class="dv">8</span><span class="op">,</span>  x<span class="op">,</span><span class="dv">7</span><span class="op">,</span> x<span class="op">,</span><span class="dv">8</span><span class="op">,</span> x<span class="op">,</span><span class="dv">3</span><span class="op">,</span> x<span class="op">,</span>x<span class="op">,</span>x<span class="op">,</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>         <span class="dv">5</span><span class="op">,</span>x<span class="op">,</span> <span class="dv">7</span><span class="op">,</span> x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span>x<span class="op">,-</span><span class="dv">5</span><span class="op">,</span>  x<span class="op">,</span><span class="dv">5</span><span class="op">,</span> x<span class="op">,</span>x<span class="op">,</span> x<span class="op">,</span>x<span class="op">,</span> x<span class="op">,</span>x<span class="op">,</span>x</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>    MIDIfile file<span class="op">;</span></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>    file<span class="op">.</span>AddLoopStart<span class="op">();</span></span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* Choose instruments (&quot;patches&quot;) for each channel: */</span></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="at">const</span> <span class="dt">char</span> patches<span class="op">[</span><span class="dv">16</span><span class="op">]</span> <span class="op">=</span></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span> <span class="dv">52</span><span class="op">,</span><span class="dv">52</span><span class="op">,</span><span class="dv">52</span><span class="op">,</span> <span class="dv">48</span><span class="op">,</span><span class="dv">48</span><span class="op">,</span><span class="dv">48</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span> <span class="dv">35</span><span class="op">,</span><span class="dv">74</span></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>        <span class="co">/* 0=piano, 52=choir aahs, 48=strings, 35=fretless bass, 74=pan flute */</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">unsigned</span> c<span class="op">=</span><span class="dv">0</span><span class="op">;</span> c<span class="op">&lt;</span><span class="dv">16</span><span class="op">;</span> <span class="op">++</span>c<span class="op">)</span></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>c <span class="op">!=</span> <span class="dv">10</span><span class="op">)</span> <span class="co">// Patch any other channel but not the percussion channel.</span></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>            file<span class="op">[</span><span class="dv">0</span><span class="op">].</span>Patch<span class="op">(</span>c<span class="op">,</span> patches<span class="op">[</span>c<span class="op">]);</span></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> keys_on<span class="op">[</span><span class="dv">16</span><span class="op">]</span> <span class="op">=</span> <span class="op">{-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span> <span class="op">};</span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">unsigned</span> loops<span class="op">=</span><span class="dv">0</span><span class="op">;</span> loops<span class="op">&lt;</span><span class="dv">2</span><span class="op">;</span> <span class="op">++</span>loops<span class="op">)</span></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">unsigned</span> row<span class="op">=</span><span class="dv">0</span><span class="op">;</span> row<span class="op">&lt;</span><span class="dv">128</span><span class="op">;</span> <span class="op">++</span>row<span class="op">)</span></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span><span class="op">(</span><span class="dt">unsigned</span> c<span class="op">=</span><span class="dv">0</span><span class="op">;</span> c<span class="op">&lt;</span><span class="dv">16</span><span class="op">;</span> <span class="op">++</span>c<span class="op">)</span></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> note <span class="op">=</span> x<span class="op">,</span> add <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> vol <span class="op">=</span> <span class="dv">127</span><span class="op">;</span></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>c <span class="op">&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="co">// Piano chord</span></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>                  <span class="op">{</span> <span class="dt">int</span> chord <span class="op">=</span> chordline<span class="op">[</span>row<span class="op">%</span><span class="dv">64</span><span class="op">];</span></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span><span class="op">(</span>chord <span class="op">!=</span> x<span class="op">)</span> note <span class="op">=</span> chords<span class="op">[</span>chord<span class="op">][</span>c<span class="op">%</span><span class="dv">3</span><span class="op">],</span> add<span class="op">=</span><span class="dv">12</span><span class="op">*</span><span class="dv">5</span><span class="op">,</span> vol<span class="op">=</span><span class="bn">0x4B</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>c <span class="op">&gt;=</span> <span class="dv">3</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;</span> <span class="dv">5</span><span class="op">)</span> <span class="co">// Aux chord (choir)</span></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>                  <span class="op">{</span> <span class="dt">int</span> chord <span class="op">=</span> chordline2<span class="op">[</span>row<span class="op">%</span><span class="dv">64</span><span class="op">];</span></span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span><span class="op">(</span>chord <span class="op">!=</span> x<span class="op">)</span> note <span class="op">=</span> chords<span class="op">[</span>chord<span class="op">][</span>c<span class="op">%</span><span class="dv">3</span><span class="op">],</span> add<span class="op">=</span><span class="dv">12</span><span class="op">*</span><span class="dv">4</span><span class="op">,</span> vol<span class="op">=</span><span class="bn">0x50</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>c <span class="op">&gt;=</span> <span class="dv">6</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;</span> <span class="dv">8</span><span class="op">)</span> <span class="co">// Aux chord (strings)</span></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>                  <span class="op">{</span> <span class="dt">int</span> chord <span class="op">=</span> chordline2<span class="op">[</span>row<span class="op">%</span><span class="dv">64</span><span class="op">];</span></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span><span class="op">(</span>chord <span class="op">!=</span> x<span class="op">)</span> note <span class="op">=</span> chords<span class="op">[</span>chord<span class="op">][</span>c<span class="op">%</span><span class="dv">3</span><span class="op">],</span> add<span class="op">=</span><span class="dv">12</span><span class="op">*</span><span class="dv">5</span><span class="op">,</span> vol<span class="op">=</span><span class="bn">0x45</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>c <span class="op">==</span> <span class="dv">14</span><span class="op">)</span> <span class="co">// Bass</span></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>                    note <span class="op">=</span> bassline<span class="op">[</span>row<span class="op">%</span><span class="dv">64</span><span class="op">],</span> add<span class="op">=</span><span class="dv">12</span><span class="op">*</span><span class="dv">3</span><span class="op">,</span> vol<span class="op">=</span><span class="bn">0x6F</span><span class="op">;</span></span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>c <span class="op">==</span> <span class="dv">15</span> <span class="op">&amp;&amp;</span> row <span class="op">&gt;=</span> <span class="dv">64</span><span class="op">)</span> <span class="co">// Flute</span></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>                    note <span class="op">=</span> fluteline<span class="op">[</span>row<span class="op">%</span><span class="dv">64</span><span class="op">],</span> add<span class="op">=</span><span class="dv">12</span><span class="op">*</span><span class="dv">5</span><span class="op">,</span> vol<span class="op">=</span><span class="bn">0x6F</span><span class="op">;</span></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>note <span class="op">==</span> x <span class="op">&amp;&amp;</span> <span class="op">(</span>c<span class="op">&lt;</span><span class="dv">15</span> <span class="op">||</span> row<span class="op">%</span><span class="dv">31</span><span class="op">))</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>                file<span class="op">[</span><span class="dv">0</span><span class="op">].</span>KeyOff<span class="op">(</span>c<span class="op">,</span> keys_on<span class="op">[</span>c<span class="op">],</span> <span class="bn">0x20</span><span class="op">);</span></span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>                keys_on<span class="op">[</span>c<span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>note <span class="op">==</span> x<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>                file<span class="op">[</span><span class="dv">0</span><span class="op">].</span>KeyOn<span class="op">(</span>c<span class="op">,</span> keys_on<span class="op">[</span>c<span class="op">]</span> <span class="op">=</span> note<span class="op">+</span>add<span class="op">,</span> vol<span class="op">);</span></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>            file<span class="op">[</span><span class="dv">0</span><span class="op">].</span>AddDelay<span class="op">(</span><span class="dv">160</span><span class="op">);</span></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>loops <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> file<span class="op">.</span>AddLoopEnd<span class="op">();</span></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>    file<span class="op">.</span>Finish<span class="op">();</span></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>    <span class="dt">FILE</span><span class="op">*</span> fp <span class="op">=</span> <span class="bu">std::</span>fopen<span class="op">(</span><span class="st">&quot;test.mid&quot;</span><span class="op">,</span> <span class="st">&quot;wb&quot;</span><span class="op">);</span></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>fwrite<span class="op">(&amp;</span>file<span class="op">.</span>at<span class="op">(</span><span class="dv">0</span><span class="op">),</span> <span class="dv">1</span><span class="op">,</span> file<span class="op">.</span>size<span class="op">(),</span> fp<span class="op">);</span></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="appendix:midi">Signaux MIDI</h1>
<h2 class="unnumbered" id="note-on-et-note-off"><em>Note On</em> et
<em>Note Off</em></h2>
<p>Les messages <em>Note On</em> et <em>Note Off</em> sont fondamentaux
en MIDI pour la gestion des notes jouées. Le message « Note On » informe
sur la touche pressée, sa vélocité et le canal MIDI concerné. Il est
composé d’un octet de statut commençant par <span
class="math inline">1001</span>, suivi de deux octets de données : le
premier pour la note jouée et le second pour la vélocité. Le message
<em>Note Off</em>, quant à lui, indique la libération d’une touche avec
les mêmes détails que <em>Note On</em>, mais avec un statut différent
commençant par <span class="math inline">1000</span> (pour rappel, à
chaque fois le <span class="math inline">1</span> est là pour préciser
qu’il s’agit d’un octet de statut). Par exemple, voici les
représentations d’un message <em>Note On</em> qui jouerait un Do avec
une vélocité maximale et celui d’un message <em>Note Off</em> qui lui
ferait miroir:</p>
<div class="sourceCode" id="cb2" data-language="GLSL"
data-caption="\textit{Note On}" data-captionpos="b"
data-frame="single"><pre class="sourceCode GLSL"><code class="sourceCode glsl"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Note On <span class="op">:</span> <span class="bn">0x9</span>n <span class="op">(</span><span class="dv">1001</span> nnnn<span class="op">)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Exemple <span class="op">:</span> <span class="bn">0x90</span> <span class="bn">0x3C</span> <span class="bn">0x7F</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bn">0x90</span> <span class="op">(</span><span class="dv">1001</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Note On sur le canal MIDI <span class="dv">1</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bn">0x3C</span> <span class="op">(</span><span class="dv">0011</span> <span class="dv">1100</span><span class="op">)</span> <span class="op">:</span> Note numero <span class="dv">60</span> <span class="op">(</span>Do central<span class="op">)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bn">0x7F</span> <span class="op">(</span><span class="dv">0111</span> <span class="dv">1111</span><span class="op">)</span> <span class="op">:</span> Velocite <span class="fu">maximale</span> <span class="op">(</span><span class="dv">127</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3" data-language="GLSL"
data-caption="\textit{Note Off}" data-captionpos="b"
data-frame="single"><pre class="sourceCode GLSL"><code class="sourceCode glsl"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Note Off <span class="op">:</span> <span class="bn">0x8</span>n <span class="op">(</span><span class="dv">1000</span> nnnn<span class="op">)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Exemple <span class="op">:</span> <span class="bn">0x80</span> <span class="bn">0x3C</span> <span class="bn">0x40</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bn">0x80</span> <span class="op">(</span><span class="dv">1000</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Note Off sur le canal MIDI <span class="dv">1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bn">0x3C</span> <span class="op">(</span><span class="dv">0011</span> <span class="dv">1100</span><span class="op">)</span> <span class="op">:</span> Note numero <span class="dv">60</span> <span class="op">(</span>Do central<span class="op">)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bn">0x40</span> <span class="op">(</span><span class="dv">0100</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Velocite <span class="dv">64</span> <span class="op">(</span>valeur typique pour un Note Off<span class="op">)</span></span></code></pre></div>
<p>L’information de vélocité est intégrée dans les messages « Note On »
et « Note Off », reflétant la vitesse à laquelle une touche est
relâchée.</p>
<h2 class="unnumbered"
id="aftertouch-polyphonic-et-aftertouch-channel"><em>Aftertouch
Polyphonic</em> et <em>Aftertouch Channel</em></h2>
<p>Les messages <em>Aftertouch</em>, qu’ils soient <em>Polyphonic</em>
ou <em>Channel</em>, renvoient des informations sur la pression
appliquée sur une touche après l’émission initiale. Bien que cette
caractéristique ne soit pas présente dans les pianos mécaniques, elle
trouve son utilité dans d’autres instruments comme les instruments à
vent ou à cordes.</p>
<p>Le <em>Polyphonic Aftertouch</em> envoie la pression individuelle
pour chaque touche pressée, nécessitant donc trois octets par note.</p>
<div class="sourceCode" id="cb4" data-language="GLSL"
data-caption="\textit{Aftertouch} Polyphonique" data-captionpos="b"
data-frame="single"><pre class="sourceCode GLSL"><code class="sourceCode glsl"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Aftertouch Polyphonique <span class="op">:</span> <span class="bn">0xA</span>n <span class="op">(</span><span class="dv">1010</span> nnnn<span class="op">)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Exemple <span class="op">:</span> <span class="bn">0xA0</span> <span class="bn">0x3C</span> <span class="bn">0x40</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bn">0xA0</span> <span class="op">(</span><span class="dv">1010</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Aftertouch Polyphonique sur le canal MIDI <span class="dv">1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="bn">0x3C</span> <span class="op">(</span><span class="dv">0011</span> <span class="dv">1100</span><span class="op">)</span> <span class="op">:</span> Note numero <span class="dv">60</span> <span class="op">(</span>Do central<span class="op">)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bn">0x40</span> <span class="op">(</span><span class="dv">0100</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Pression de la touche</span></code></pre></div>
<p>Par contre le <em>Channel Aftertouch</em> envoie uniquement la
pression de la touche avec la pression la plus élevée, nécessitant
seulement deux octets.</p>
<div class="sourceCode" id="cb5" data-language="GLSL"
data-caption="\textit{Aftertouch} de canal" data-captionpos="b"
data-frame="single"><pre class="sourceCode GLSL"><code class="sourceCode glsl"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Aftertouch de <span class="fu">canal</span> <span class="op">(</span>Channel Aftertouch<span class="op">)</span> <span class="op">:</span> <span class="bn">0xD</span>n <span class="op">(</span><span class="dv">1101</span> nnnn<span class="op">)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Exemple <span class="op">:</span> <span class="bn">0xD0</span> <span class="bn">0x40</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bn">0xD0</span> <span class="op">(</span><span class="dv">1101</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Aftertouch de canal sur le canal MIDI <span class="dv">1</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bn">0x40</span> <span class="op">(</span><span class="dv">0100</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Pression de la touche</span></code></pre></div>
<h2 class="unnumbered"
id="changement-de-contrôle-control-change">Changement de contrôle
(<em>Control Change</em>)</h2>
<p>Le message <em>Control Change</em> transmet des informations sur les
contrôleurs tels que les boutons, pédales et curseurs. Ce message est
constitué d’un octet de statut avec un préfixe <span
class="math inline">1011</span>, suivi du canal, du numéro du
contrôleur, et de la valeur (de <span class="math inline">0</span> à
<span class="math inline">127</span>).</p>
<div class="sourceCode" id="cb6" data-language="GLSL"
data-caption="Changement de contrôle" data-captionpos="b"
data-frame="single"><pre class="sourceCode GLSL"><code class="sourceCode glsl"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Changement de <span class="fu">controle</span> <span class="op">(</span>Control Change<span class="op">)</span> <span class="op">:</span> <span class="bn">0xB0</span> <span class="op">(</span><span class="dv">1011</span> nnnn<span class="op">)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Exemple <span class="op">:</span> <span class="bn">0xB0</span> <span class="bn">0x07</span> <span class="bn">0x64</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bn">0xB0</span> <span class="op">(</span><span class="dv">1011</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Controle de changement sur le canal MIDI <span class="dv">1</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bn">0x07</span> <span class="op">(</span><span class="dv">0000</span> <span class="dv">0111</span><span class="op">)</span> <span class="op">:</span> Numero de <span class="fu">controleur</span> <span class="op">(</span>ici<span class="op">,</span> le controle de volume<span class="op">)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bn">0x64</span> <span class="op">(</span><span class="dv">0110</span> <span class="dv">0100</span><span class="op">)</span> <span class="op">:</span> Valeur du <span class="fu">controle</span> <span class="op">(</span><span class="dv">100</span> en decimal<span class="op">,</span> indiquant le volume a <span class="dv">100</span><span class="op">)</span></span></code></pre></div>
<h2 class="unnumbered"
id="changement-de-programme-program-change">Changement de Programme
(<em>Program Change</em>)</h2>
<p>Bien que considéré comme une relique des débuts des synthétiseurs
logiciels, le message <em>Program Change</em> était utilisé pour
signaler les changements de patch. À l’origine, avec <span
class="math inline">127</span> voix disponibles dans tous les
synthétiseurs MIDI, ce système était particulièrement adapté aux jeux
vidéo, permettant une expérience musicale cohérente sur différents
matériels. Ces <span class="math inline">127</span> voix incluent
également des effets sonores comme le chant des oiseaux ou le bruit de
téléphone. Les messages <em>Program Change</em> se composent de deux
octets : un octet de statut commençant par <span
class="math inline">1100</span>, indiquant le canal, suivi d’un octet de
données désignant le nouvel instrument.</p>
<div class="sourceCode" id="cb7" data-language="GLSL"
data-caption="Changement de programme" data-captionpos="b"
data-frame="single"><pre class="sourceCode GLSL"><code class="sourceCode glsl"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Changement de <span class="fu">programme</span> <span class="op">(</span>Program Change<span class="op">)</span> <span class="op">:</span> <span class="bn">0xC</span>n <span class="op">(</span><span class="dv">1100</span> nnnn<span class="op">)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Exemple <span class="op">:</span> <span class="bn">0xC0</span> <span class="bn">0x04</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bn">0xC0</span> <span class="op">(</span><span class="dv">1100</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Changement de programme sur le canal MIDI <span class="dv">1</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bn">0x04</span> <span class="op">(</span><span class="dv">0000</span> <span class="dv">0100</span><span class="op">)</span> <span class="op">:</span> Programme numero <span class="dv">5</span></span></code></pre></div>
<h2 class="unnumbered" id="pitch-bend"><em>Pitch Bend</em></h2>
<p>Le <em>Pitch Bend</em> se distingue des autres contrôleurs continus
par sa résolution plus élevée dans le protocole MIDI. Au lieu d’utiliser
une plage de valeurs de <span class="math inline">0</span> à <span
class="math inline">127</span>, le <em>Pitch Bend</em> utilise deux
octets pour fournir une résolution de 14 bits, offrant <span
class="math inline">16384</span> (<span
class="math inline">2<sup>14</sup></span>) valeurs possibles. Cette
précision est essentielle pour un contrôle microtonal détaillé, ce qui
est particulièrement utile pour des données à haute résolution dans le
protocole MIDI.</p>
<div class="sourceCode" id="cb8" data-language="GLSL"
data-caption="Pitch Bend" data-captionpos="b" data-frame="single"><pre
class="sourceCode GLSL"><code class="sourceCode glsl"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Pitch Bend <span class="op">:</span> <span class="bn">0xE</span>n <span class="op">(</span><span class="dv">1110</span> nnnn<span class="op">)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Exemple <span class="op">:</span> <span class="bn">0xE0</span> <span class="bn">0x00</span> <span class="bn">0x40</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bn">0xE0</span> <span class="op">(</span><span class="dv">1110</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Pitch Bend sur le canal MIDI <span class="dv">1</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bn">0x00</span> <span class="bn">0x40</span> <span class="op">(</span><span class="dv">0000</span> <span class="dv">0000</span> <span class="dv">0100</span> <span class="dv">0000</span><span class="op">)</span> <span class="op">:</span> Valeur du pitch <span class="fu">bend</span> <span class="op">(</span>vers le haut<span class="op">)</span></span></code></pre></div>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>Dans la culture de la <em>demoscene</em>, les
<em>greetings</em> sont des salutations, souvent inclues dans les
<em>demos</em>, adressées à d’autres groupes de la <em>demoscene</em>, à
des personnes spécifiques ou à la communauté dans son ensemble.<a
href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Un <em>hackerspace</em> est un espace physique où des
passionnés de technologie, de programmation informatique et de création
collaborative se réunissent pour travailler sur des projets, échanger
des connaissances et partager des ressources.<a href="#fnref2"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>L’esprit <em>open source</em> se réfère à une approche
collaborative et transparente du développement de logiciels et de
technologies, basée sur le partage libre et ouvert du code source. Les
projets <em>open source</em> permettent à quiconque d’accéder,
d’étudier, de modifier et de redistribuer le code source d’un logiciel,
favorisant ainsi la collaboration et l’innovation collective.<a
href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Les <em>free parties</em> sont des événements musicaux
et culturels autonomes, souvent organisés de manière clandestine et sans
autorisation officielle, caractérisés par une programmation musicale
centrée sur la musique électronique <em>underground</em>. Ces événements
se déroulent généralement dans des lieux inhabituels ou alternatifs,
tels que des entrepôts abandonnés, des champs, des forêts ou des
<em>squats</em>.<a href="#fnref4" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>La gravure musicale est le processus de notation ou de
transcription de la musique dans un format numérique à l’aide de
logiciels spécialisés. Cette pratique consiste à représenter les
éléments musicaux tels que les notes, les rythmes, les indications de
tempo, les dynamiques et d’autres instructions d’interprétation de
manière visuelle et compréhensible pour les musiciens. Les principales
solutions logicielles de gravure musicale comprennent des programmes
tels que Finale, MuseScore et LilyPond (ma solution privilégiée).<a
href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Un <em>proof of concept</em> (POC), traduit
littéralement en français par « preuve de concept », est une
démonstration ou un prototype qui vise à prouver la faisabilité ou la
viabilité d’une idée, d’un concept ou d’une méthode.<a href="#fnref6"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
